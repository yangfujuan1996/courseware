<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>
<body>

    <h2>ajax同源策略</h2>
    
</body>
</html>

<script>
    /*
    同源策略：
        两个资源之间 主机地址 端口 协议 三者必须都是相同的，成为同源的，否则就是不同源的

        在访问的链接与页面中请求链接的主机地址必须相同，不相同会出现跨域的情况
    
    localhost 域名  qq.com   163.com
    127.0.0.1  本机IP地址
    查看本机的ip地址也可以访问

    访问一个网站
        既可以使用域名的方式，也可以使用IP的方式

    ajax只能访问同源下的资源 （浏览器的安全限制）

    向后端请求数据需要知道什么？
        1、请求地址                     url
        2、以什么方式请求                method
        3、什么时候请求是成功的          onload
        4、请求成功后应该怎么处理数据    ajax对象
       
    */

    /*
    HTML和XML的作用：
    HTML ：数据展示
    XML ： 数据存储
    */




    // ajax请求流程（步骤）
    // asyncronous  javascript and XML


    // 1、创建ajax对象（通过ajax对象发起请求的申请）
    var xhr = new XMLHttpRequest();

    // 2、配置请求参数   url地址 和 请求方式
    // xhr.open('get', 'getData.php'); // 比通过url建立连接请求
    // xhr.open('get', 'test.txt');
    // xhr.open('get', 'demo.xml')
    // 完整链接形式
    // xhr.open('get', 'http://localhost/demo.xml')
    // xhr.open('get', 'http://127.0.0.1/demo.xml')
    // xhr.open('get', 'http://172.28.44.87/demo.xml')
    xhr.open('get', 'http://dabaojian.applinzi.com/data/books.php')


    // 4、处理请求之后的数据
    // 无论请求是否成功，请求结果都会保存在XMLHttpRequest对象中
        // a,成功   onload事件会被触发
        xhr.onload = function () {
            // console.log(xhr, 'onload')
            // 接收文本形式的数据
            console.log(xhr);
            console.log(JSON.parse(xhr.responseText));
            

            // 处理xml文档的方式
            // var data = xhr.responseXML;
            // var names = data.getElementsByTagName('name');
            // console.log(names[0].innerHTML);
        };
        // b,失败   onerror事件会被触发
        xhr.onerror = function () {
            console.log(xhr, 'error')
        };
        // c,请求被中止   onabort   事件被触发
        xhr.onabort = function () {};

    // 3、发送请求
    xhr.send(null);   // get请求，send不需要参数




</script>